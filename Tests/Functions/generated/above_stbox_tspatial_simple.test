# name: function/spatiotemporal/MEOS_Above_STBox_TSpatial_Simple.test
# description: Test ABOVE_STBOX_TSPATIAL function with STBox and temporal geometry parameters
# groups: [Function, MEOS, SpatioTemporal, STBox, TSpatial, Above]

# Test 1: STBox above temporal geometry (true cases)
Source stbox_above_tests UINT32 test_id VARSIZED stbox_param VARSIZED tgeom_param
Attach File CSV nes-systests/configs/inputFormatters/csv_pipe_delimiter.yaml stbox_above_tests INLINE
1|'SRID=4326;STBOX XT(((1.0, 3.0), (2.0, 4.0)), [2000-01-01, 2000-01-03])'|'SRID=4326;POINT(1.5 1.5)@2000-01-01 00:00:00+00'
2|'SRID=4326;STBOX XT(((0.0, 5.0), (3.0, 8.0)), [2000-01-01, 2000-01-03])'|'SRID=4326;POINT(1.0 2.0)@2000-01-01 00:00:00+00'
3|'SRID=4326;STBOX XT(((-1.0, 10.0), (1.0, 12.0)), [2000-01-01, 2000-01-03])'|'SRID=4326;POINT(0.0 5.0)@2000-01-01 00:00:00+00'

SINK stbox_above_results UINT32 stbox_above_tests$test_id INT32 stbox_above_tests$above_result

SELECT test_id,
       ABOVE_STBOX_TSPATIAL(stbox_param, tgeom_param) AS above_result
FROM stbox_above_tests
INTO stbox_above_results
----
1,1
2,1
3,1

# Test 2: STBox not above temporal geometry (false cases)
Source stbox_not_above_tests UINT32 test_id VARSIZED stbox_param VARSIZED tgeom_param
Attach File CSV nes-systests/configs/inputFormatters/csv_pipe_delimiter.yaml stbox_not_above_tests INLINE
1|'SRID=4326;STBOX XT(((1.0, 1.0), (2.0, 2.0)), [2000-01-01, 2000-01-03])'|'SRID=4326;POINT(1.5 3.5)@2000-01-01 00:00:00+00'
2|'SRID=4326;STBOX XT(((0.0, 2.0), (3.0, 5.0)), [2000-01-01, 2000-01-03])'|'SRID=4326;POINT(1.0 6.0)@2000-01-01 00:00:00+00'
3|'SRID=4326;STBOX XT(((-1.0, 5.0), (1.0, 7.0)), [2000-01-01, 2000-01-03])'|'SRID=4326;POINT(0.0 8.0)@2000-01-01 00:00:00+00'

SINK stbox_not_above_results UINT32 stbox_not_above_tests$test_id INT32 stbox_not_above_tests$above_result

SELECT test_id,
       ABOVE_STBOX_TSPATIAL(stbox_param, tgeom_param) AS above_result
FROM stbox_not_above_tests
INTO stbox_not_above_results
----
1,0
2,0
3,0