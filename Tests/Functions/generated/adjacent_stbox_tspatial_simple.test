# name: function/spatiotemporal/MEOS_Adjacent_STBox_TSpatial_Simple.test
# description: Test ADJACENT_STBOX_TSPATIAL function with STBox adjacent to temporal geometry
# groups: [Function, MEOS, SpatioTemporal, STBox, TSpatial, Adjacent]

# Test 1: STBox adjacent to temporal geometry (true cases)
Source stbox_adjacent_tests UINT32 test_id VARSIZED stbox_param VARSIZED tgeom_param
Attach File CSV nes-systests/configs/inputFormatters/csv_pipe_delimiter.yaml stbox_adjacent_tests INLINE
1|'SRID=4326;STBOX XT(((0.0, 0.0), (1.0, 1.0)), [2000-01-01, 2000-01-03])'|'SRID=4326;POINT(1.5 0.5)@2000-01-02 00:00:00+00'
2|'SRID=4326;STBOX XT(((2.0, 2.0), (3.0, 3.0)), [2000-01-01, 2000-01-03])'|'SRID=4326;POINT(1.5 2.5)@2000-01-02 00:00:00+00'
3|'SRID=4326;STBOX XT(((0.0, 0.0), (2.0, 2.0)), [2000-01-01, 2000-01-03])'|'SRID=4326;POINT(0.0 2.5)@2000-01-02 00:00:00+00'

SINK stbox_adjacent_results UINT32 stbox_adjacent_tests$test_id INT32 stbox_adjacent_tests$adjacent_result

SELECT test_id,
       ADJACENT_STBOX_TSPATIAL(stbox_param, tgeom_param) AS adjacent_result
FROM stbox_adjacent_tests
INTO stbox_adjacent_results
----
1,1
2,1
3,1

# Test 2: STBox not adjacent to temporal geometry (false cases)
Source stbox_not_adjacent_tests UINT32 test_id VARSIZED stbox_param VARSIZED tgeom_param
Attach File CSV nes-systests/configs/inputFormatters/csv_pipe_delimiter.yaml stbox_not_adjacent_tests INLINE
1|'SRID=4326;STBOX XT(((0.0, 0.0), (1.0, 1.0)), [2000-01-01, 2000-01-03])'|'SRID=4326;POINT(0.5 0.5)@2000-01-02 00:00:00+00'
2|'SRID=4326;STBOX XT(((2.0, 2.0), (3.0, 3.0)), [2000-01-01, 2000-01-03])'|'SRID=4326;POINT(5.0 5.0)@2000-01-02 00:00:00+00'
3|'SRID=4326;STBOX XT(((0.0, 0.0), (2.0, 2.0)), [2000-01-01, 2000-01-03])'|'SRID=4326;POINT(1.0 1.0)@2000-01-02 00:00:00+00'

SINK stbox_not_adjacent_results UINT32 stbox_not_adjacent_tests$test_id INT32 stbox_not_adjacent_tests$adjacent_result

SELECT test_id,
       ADJACENT_STBOX_TSPATIAL(stbox_param, tgeom_param) AS adjacent_result
FROM stbox_not_adjacent_tests
INTO stbox_not_adjacent_results
----
1,0
2,0
3,0

# Test 3: Edge cases - Points on boundary
Source stbox_boundary_tests UINT32 test_id VARSIZED stbox_param VARSIZED tgeom_param
Attach File CSV nes-systests/configs/inputFormatters/csv_pipe_delimiter.yaml stbox_boundary_tests INLINE
1|'SRID=4326;STBOX XT(((0.0, 0.0), (2.0, 2.0)), [2000-01-01, 2000-01-03])'|'SRID=4326;POINT(2.0 1.0)@2000-01-02 00:00:00+00'
2|'SRID=4326;STBOX XT(((1.0, 1.0), (3.0, 3.0)), [2000-01-01, 2000-01-03])'|'SRID=4326;POINT(1.0 2.0)@2000-01-02 00:00:00+00'

SINK stbox_boundary_results UINT32 stbox_boundary_tests$test_id INT32 stbox_boundary_tests$adjacent_result

SELECT test_id,
       ADJACENT_STBOX_TSPATIAL(stbox_param, tgeom_param) AS adjacent_result
FROM stbox_boundary_tests
INTO stbox_boundary_results
----
1,1
2,1