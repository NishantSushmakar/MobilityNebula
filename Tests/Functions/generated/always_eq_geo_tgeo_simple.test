# name: function/spatiotemporal/MEOS_AlwaysEq_GeoTgeo_Simple.test  
# description: Simple test for ALWAYS_EQ_GEO_TGEO function with static geometry vs temporal geometry
# groups: [Function, MEOS, SpatioTemporal, Geometry, TemporalGeometry, AlwaysEq, Simple]

# Test static geometry always equals temporal geometry (true cases)
Source always_eq_true_tests UINT32 test_id VARSIZED static_geo VARSIZED tgeo
Attach File CSV nes-systests/configs/inputFormatters/csv_pipe_delimiter.yaml always_eq_true_tests INLINE
1|'SRID=4326;POINT(-73.9855 40.7485)'|'SRID=4326;POINT(-73.9855 40.7485)@2021-01-01 00:00:00+00'
2|'SRID=4326;POINT(-73.9850 40.7480)'|'SRID=4326;{POINT(-73.9850 40.7480)@2021-01-01 00:00:00+00, POINT(-73.9850 40.7480)@2021-01-01 00:01:00+00}'
3|'SRID=4326;LINESTRING(-73.9850 40.7480, -73.9860 40.7490)'|'SRID=4326;LINESTRING(-73.9850 40.7480, -73.9860 40.7490)@2021-01-01 00:00:00+00'

SINK always_eq_true_results UINT32 always_eq_true_tests$test_id INT32 always_eq_true_tests$always_eq_result

SELECT test_id,
       ALWAYS_EQ_GEO_TGEO(static_geo, tgeo) AS always_eq_result
FROM always_eq_true_tests
INTO always_eq_true_results
----
1,1
2,1
3,1

# Test static geometry not always equals temporal geometry (false cases)
Source always_eq_false_tests UINT32 test_id VARSIZED static_geo VARSIZED tgeo
Attach File CSV nes-systests/configs/inputFormatters/csv_pipe_delimiter.yaml always_eq_false_tests INLINE
1|'SRID=4326;POINT(-73.9855 40.7485)'|'SRID=4326;POINT(-73.9860 40.7490)@2021-01-01 00:00:00+00'
2|'SRID=4326;POINT(-73.9850 40.7480)'|'SRID=4326;{POINT(-73.9850 40.7480)@2021-01-01 00:00:00+00, POINT(-73.9855 40.7485)@2021-01-01 00:01:00+00}'
3|'SRID=4326;LINESTRING(-73.9850 40.7480, -73.9860 40.7490)'|'SRID=4326;LINESTRING(-73.9850 40.7480, -73.9855 40.7485)@2021-01-01 00:00:00+00'
4|'SRID=4326;POLYGON((-73.9860 40.7480, -73.9850 40.7480, -73.9850 40.7490, -73.9860 40.7490, -73.9860 40.7480))'|'SRID=4326;POINT(-73.9855 40.7485)@2021-01-01 00:00:00+00'

SINK always_eq_false_results UINT32 always_eq_false_tests$test_id INT32 always_eq_false_tests$always_eq_result

SELECT test_id,
       ALWAYS_EQ_GEO_TGEO(static_geo, tgeo) AS always_eq_result
FROM always_eq_false_tests
INTO always_eq_false_results
----
1,0
2,0
3,0
4,0